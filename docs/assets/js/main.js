"use strict";let favoriteProgram=[];favoriteProgram=JSON.parse(localStorage.getItem("fav"));const inputSearchEl=document.querySelector(".search-bar"),buttonSearchEl=document.querySelector(".btn-search"),listResultEl=document.querySelector(".search-list"),listFavEl=document.querySelector(".fav-list");function handlerButtonClick(){listResultEl.innerHTML="",""===inputSearchEl.value?showAllProgram():showSearchProgram()}function showAllProgram(){fetch("http://api.tvmaze.com/shows").then(t=>t.json()).then(function(t){for(let e=0;e<t.length;e++){const r=t[e],{name:n}=r,a=document.createElement("li");a.setAttribute("class","list-li");const s=document.createElement("h2");s.setAttribute("class","title-program");const l=document.createTextNode(n),o=document.createElement("img");if(o.setAttribute("class","image-program"),o.setAttribute("alt",n),null===r.image){const t="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";o.setAttribute("src",t)}else{const{image:{medium:t}}=r;o.setAttribute("src",t)}s.appendChild(l),a.appendChild(s),a.appendChild(o),listResultEl.appendChild(a)}const e=document.querySelectorAll(".list-li");for(let t=0;t<e.length;t++)e[t].addEventListener("click",r);function r(t){const e=t.currentTarget,r=e.outerText,n=e.lastChild.src;let a={name:r,image:n};if(favoriteProgram.push(a),localStorage.setItem("fav",JSON.stringify(favoriteProgram)),e.classList.toggle("favorite"),e.classList.contains("favorite")){const t=document.createElement("li");t.setAttribute("class","list-li-fav");const e=document.createElement("h2");e.setAttribute("class","title-program-fav");const a=document.createElement("img");a.setAttribute("class","image-program-fav"),a.setAttribute("alt",r),a.setAttribute("src",n);const s=document.createElement("button");s.setAttribute("type","button"),s.setAttribute("class","btn-reset");const l=document.createTextNode("X");s.appendChild(l),e.innerHTML=r,t.appendChild(e),t.appendChild(s),t.appendChild(a),listFavEl.appendChild(t)}}})}function showSearchProgram(){const t=inputSearchEl.value;fetch("http://api.tvmaze.com/search/shows?q="+t).then(t=>t.json()).then(function(t){for(let e=0;e<t.length;e++){const r=t[e],{show:{name:n}}=r,a=document.createElement("li");a.setAttribute("class","list-li");const s=document.createElement("h2");s.setAttribute("class","title-program");const l=document.createTextNode(n),o=document.createElement("img");if(o.setAttribute("class","image-program"),o.setAttribute("alt",n),null===r.show.image){const t="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";o.setAttribute("src",t)}else{const{show:{image:{medium:t}}}=r;o.setAttribute("src",t)}s.appendChild(l),a.appendChild(s),a.appendChild(o),listResultEl.appendChild(a)}const e=document.querySelectorAll(".list-li");for(let t=0;t<e.length;t++)e[t].addEventListener("click",n);const r=[];function n(t){const e=t.currentTarget,n=e.outerText,a=e.lastChild.src;let s={name:n,image:a};if(r.push(s),localStorage.setItem("fav",JSON.stringify(r)),e.classList.toggle("favorite"),e.classList.contains("favorite")){const t=document.createElement("li");t.setAttribute("class","list-li-fav");const e=document.createElement("h2");e.setAttribute("class","title-program-fav");const r=document.createElement("img");r.setAttribute("class","image-program-fav"),r.setAttribute("alt",n),r.setAttribute("src",a);const s=document.createElement("button");s.setAttribute("type","button"),s.setAttribute("class","btn-reset");const l=document.createTextNode("X");s.appendChild(l),e.innerHTML=n,t.appendChild(e),t.appendChild(s),t.appendChild(r),listFavEl.appendChild(t)}}})}buttonSearchEl.addEventListener("click",handlerButtonClick);for(let t=0;t<favoriteProgram.length;t++){const e=favoriteProgram[t],{name:r}=e,{image:n}=e,a=document.createElement("li");a.setAttribute("class","list-li-fav");const s=document.createElement("h2");s.setAttribute("class","title-program-fav");const l=document.createElement("img");l.setAttribute("class","image-program-fav"),l.setAttribute("alt",r),l.setAttribute("src",n);const o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("class","btn-reset");const i=document.createTextNode("X");o.appendChild(i),s.innerHTML=r,a.appendChild(s),a.appendChild(o),a.appendChild(l),listFavEl.appendChild(a)}const btnReset=document.querySelectorAll(".btn-reset");for(let t=0;t<btnReset.length;t++)btnReset[t].addEventListener("click",handlerButtonReset);function handlerButtonReset(t){const e=t.currentTarget.parentElement;e.remove();for(let t=0;t<favoriteProgram.length;t++){const r=favoriteProgram[t],{name:n}=r;if(n===e.firstChild.innerHTML){console.log(favoriteProgram[t]);const e=favoriteProgram.indexOf(favoriteProgram[t]);favoriteProgram.splice(e,1),localStorage.setItem("fav",JSON.stringify(favoriteProgram))}}}